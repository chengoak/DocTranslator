import{_ as B,u as K,r as m,Q as g,c as N,a as p,a8 as z,g as o,w as s,I as D,y as u,o as L,a9 as U,A as _,t as $,E as t}from"./index-B_1xGcKF.js";import{r as A,l as M,a as Q}from"./auth-BXzzagA-.js";const j={class:"auth-page"},G={class:"auth-container"},H={class:"auth-actions"},J={__name:"index",setup(O){const C=K(),b=D(),w=m("login"),y=m(null),d=g({email:"",password:""}),F=g({email:[{required:!0,message:"请填写邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请填写密码",trigger:"blur"}]}),l=g({email:"",code:"",password:"",password2:""}),q=g({email:[{required:!0,message:"请填写邮箱地址",trigger:"blur"}],code:[{required:!0,message:"请填写邮箱验证码",trigger:"blur"}],password:[{required:!0,message:"请填写密码",trigger:"blur"}],password2:[{required:!0,message:"请填写确认密码",trigger:"blur"}]}),v=m(null),c=m("发送"),f=m(!1),T=async()=>{if(!f.value){if(!l.email.trim()){t.error("请填写邮箱地址");return}try{await A(l.email),t.success("验证码已发送"),f.value=!0;let a=60;c.value=`${a}s`;const e=setInterval(()=>{if(a<=0){clearInterval(e),f.value=!1,c.value="发送";return}a--,c.value=`${a}s`},1e3)}catch(a){t.error(a.message)}}},k=async()=>{y.value.validate(a=>{a?M(d).then(e=>{e.code===200?(C.updateToken(e.data.token),b.push({name:"home"})):t.error(e.message)}).catch(e=>{t.error(e.message)}):t.error("请正确填写表单")})},x=async()=>{v.value&&v.value.validate(a=>{if(a){if(l.password!==l.password2){t.error("两次密码输入不一致");return}Q(l).then(e=>{e.code===200?(t.success("注册成功"),w.value="login"):t.error(e.message)}).catch(e=>{t.error(e.message)})}else t.error("请正确填写表单")})},E=()=>{b.push({name:"forget"})};return(a,e)=>{const i=u("el-input"),n=u("el-form-item"),I=u("el-link"),V=u("el-button"),h=u("el-form"),R=u("el-tab-pane"),S=u("el-tabs");return L(),N("div",j,[p("div",G,[e[10]||(e[10]=p("div",{class:"auth-header"},[p("img",{src:z,alt:"Logo",class:"auth-logo"}),p("h1",{class:"auth-title"},"欢迎回来"),p("p",{class:"auth-subtitle"},"请登录或注册以继续")],-1)),o(S,{modelValue:w.value,"onUpdate:modelValue":e[6]||(e[6]=r=>w.value=r),stretch:"",class:"auth-tabs"},{default:s(()=>[o(R,{label:"登录",name:"login"},{default:s(()=>[o(h,{model:d,ref_key:"loginFormRef",ref:y,rules:F,onKeyup:U(k,["enter"])},{default:s(()=>[o(n,{prop:"email"},{default:s(()=>[o(i,{modelValue:d.email,"onUpdate:modelValue":e[0]||(e[0]=r=>d.email=r),placeholder:"邮箱","prefix-icon":"el-icon-message"},null,8,["modelValue"])]),_:1}),o(n,{prop:"password"},{default:s(()=>[o(i,{modelValue:d.password,"onUpdate:modelValue":e[1]||(e[1]=r=>d.password=r),type:"password","show-password":"",placeholder:"密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]),_:1}),p("div",H,[o(I,{type:"primary",class:"forget-link",onClick:E},{default:s(()=>e[7]||(e[7]=[_(" 忘记密码? ")])),_:1})]),o(n,{class:"center"},{default:s(()=>[o(V,{type:"primary",size:"large",class:"auth-btn",onClick:k},{default:s(()=>e[8]||(e[8]=[_(" 登录 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1}),o(R,{label:"注册",name:"register"},{default:s(()=>[o(h,{model:l,ref_key:"registerFormRef",ref:v,rules:q,onKeyup:U(x,["enter"])},{default:s(()=>[o(n,{prop:"email"},{default:s(()=>[o(i,{modelValue:l.email,"onUpdate:modelValue":e[2]||(e[2]=r=>l.email=r),placeholder:"输入邮箱","prefix-icon":"el-icon-message"},null,8,["modelValue"])]),_:1}),o(n,{prop:"code"},{default:s(()=>[o(i,{modelValue:l.code,"onUpdate:modelValue":e[3]||(e[3]=r=>l.code=r),placeholder:"邮箱验证码","prefix-icon":"el-icon-key"},{suffix:s(()=>[o(V,{type:"text",class:"code-btn",onClick:T,disabled:f.value},{default:s(()=>[_($(c.value),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),o(n,{prop:"password"},{default:s(()=>[o(i,{modelValue:l.password,"onUpdate:modelValue":e[4]||(e[4]=r=>l.password=r),type:"password","show-password":"",placeholder:"输入密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]),_:1}),o(n,{prop:"password2"},{default:s(()=>[o(i,{modelValue:l.password2,"onUpdate:modelValue":e[5]||(e[5]=r=>l.password2=r),type:"password","show-password":"",placeholder:"确认输入密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]),_:1}),o(n,{class:"center"},{default:s(()=>[o(V,{type:"primary",size:"large",class:"auth-btn",onClick:x},{default:s(()=>e[9]||(e[9]=[_(" 提交 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue"])])])}}},X=B(J,[["__scopeId","data-v-077425d6"]]);export{X as default};
